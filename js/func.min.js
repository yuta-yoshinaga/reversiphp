function cnvHexToRgb(e){var r=e.toString();if(r.length<6)var t=r.match(/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})/),i=t[1]+t[1],a=t[2]+t[2],s=t[3]+t[3];else var n=r.match(/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/),i=n[1],a=n[2],s=n[3];var l=parseInt(i,16),o=parseInt(a,16),v=parseInt(s,16);return rgbObj=new Object,rgbObj.r=l,rgbObj.g=o,rgbObj.b=v,rgbObj}function cnvRgbToHex(e,r,t){var i=e.toString(10),a=r.toString(10),s=t.toString(10),n=parseInt(i).toString(16),l=parseInt(a).toString(16),o=parseInt(s).toString(16);n=n.replace(/(^[0-9a-fA-F]{1}$)/,"0$1"),l=l.replace(/(^[0-9a-fA-F]{1}$)/,"0$1"),o=o.replace(/(^[0-9a-fA-F]{1}$)/,"0$1");var v="#"+n+l+o;return v}function set_menu_ui(){$("#appMenuModal .appMenuGrp label").each(function(){$(this).removeClass("active")});var e;e=$('#mMode input[value="'+Number(reversiSetting.mMode)+'"]').parent().addClass("active"),e=$('#mType input[value="'+Number(reversiSetting.mType)+'"]').parent().addClass("active"),e=$('#mPlayer input[value="'+Number(reversiSetting.mPlayer)+'"]').parent().addClass("active"),e=$('#mAssist input[value="'+Number(reversiSetting.mAssist)+'"]').parent().addClass("active"),e=$('#mGameSpd input[value="'+Number(reversiSetting.mGameSpd)+'"]').parent().addClass("active"),e=$('#mEndAnim input[value="'+Number(reversiSetting.mEndAnim)+'"]').parent().addClass("active"),e=$('#mMasuCntMenu input[value="'+Number(reversiSetting.mMasuCntMenu)+'"]').parent().addClass("active"),e=$('#mTheme input[value="'+reversiSetting.mTheme+'"]').parent().addClass("active"),e=$("#mPlayerColor1 input").attr("value",reversiSetting.mPlayerColor1),e=$("#mPlayerColor1 input").minicolors("value",reversiSetting.mPlayerColor1),e=$("#mPlayerColor2 input").attr("value",reversiSetting.mPlayerColor2),e=$("#mPlayerColor2 input").minicolors("value",reversiSetting.mPlayerColor2),e=$("#mBackGroundColor input").attr("value",reversiSetting.mBackGroundColor),e=$("#mBackGroundColor input").minicolors("value",reversiSetting.mBackGroundColor),e=$("#mBorderColor input").attr("value",reversiSetting.mBorderColor),e=$("#mBorderColor input").minicolors("value",reversiSetting.mBorderColor);var r=reversiSetting.mTheme;$('head link[href="./css/theme/'+r+'/bootstrap.min.css"]').remove();var t='<link href="./css/theme/'+reversiSetting.mTheme+'/bootstrap.min.css" rel="stylesheet" media="screen">';$("head").append(t)}function set_masu_size_squer(){var e,r,t=$(window).height(),i=$(window).width(),a=100;console.log("height : "+t+"px"),console.log("width : "+i+"px"),r=i>t?t-a:i-a,e=r/reversiSetting.mMasuCnt,$(".reversi_field").width(Math.ceil(e*reversiSetting.mMasuCnt)+1+"px"),$(".reversi_field").height(Math.ceil(e*reversiSetting.mMasuCnt)+1+"px"),$(".reversi_field .square-wrapper").each(function(){$(this).css("width",e+"px"),$(this).css("height",e+"px")}),$(".reversi_field .square-wrapper .content").each(function(){$(this).css("line-height",.9*e+"px")})}function appInit(){$(".reversi_field").empty();for(var e=0;e<reversiSetting.mMasuCnt;e++){var r=$('<div class="my_row"></div>');r.addClass("pos_row"+String(e)),$(".reversi_field").append(r);for(var t=0;t<reversiSetting.mMasuCnt;t++){var i=$('<div class="square-wrapper"><div class="spacer"><div class="content"></div></div></div>');i.addClass("pos_x"+String(t)),i.addClass("pos_y"+String(e)),i.attr("data-x",String(t)),i.attr("data-y",String(e)),i.css("border-color",reversiSetting.mBorderColor),$(".pos_row"+String(e)).append(i)}}$(".reversi_field").append('<div class="clearfix"></div>'),$(".reversi_field").append('<div class="cur_col_msg"></div>'),$(".reversi_field").append('<div class="cur_sts_msg"></div>'),$(".reversi_field").append('<div class="col-xs-3">&nbsp;</div>'),$(".reversi_field").append('<div class="col-xs-3"><button type="button" class="btn btn-primary btn-sm reset">リセット</button></div>'),$(".reversi_field").append('<div class="col-xs-3"><button type="button" class="btn btn-info btn-sm setting" data-toggle="modal" data-target="#appMenuModal">設定</button></div>'),$(".reversi_field").append('<div class="col-xs-3">&nbsp;</div>'),$(".reversi_field").append('<div class="clearfix"></div>'),drawAll(),set_masu_size_squer()}function drawAll(){$(".reversi_field .square-wrapper").each(function(e,r){var t=$(this).data("x"),i=$(this).data("y");drawSingle(i,t,REVERSI_STS_NONE,0,"")})}function viewMsgDlg(e,r){alert(e+"\n"+r)}function drawSingle(e,r,t,i,a){var s=$('.reversi_field .square-wrapper[data-x="'+r+'"][data-y="'+e+'"]'),n=s.find(".content");t==REVERSI_STS_NONE?(n.removeClass("stone_white"),n.removeClass("stone_black"),n.css("background-color","transparent")):t==REVERSI_STS_BLACK?(n.removeClass("stone_white"),n.addClass("stone_black"),n.css("background-color",reversiSetting.mPlayerColor1)):t==REVERSI_STS_WHITE&&(n.addClass("stone_white"),n.removeClass("stone_black"),n.css("background-color",reversiSetting.mPlayerColor2));var l=reversiSetting.mBackGroundColor;if(1==i){s.removeClass("cell_back_green"),s.removeClass("cell_back_magenta"),s.removeClass("cell_back_red"),s.addClass("cell_back_blue");var o=cnvHexToRgb(l);o.g-=127,o.g<0&&(o.g+=255),o.b+=255,255<o.b&&(o.b-=255),l=cnvRgbToHex(o.r,o.g,o.b)}else if(2==i){s.removeClass("cell_back_green"),s.removeClass("cell_back_magenta"),s.addClass("cell_back_red"),s.removeClass("cell_back_blue");var o=cnvHexToRgb(l);o.r+=255,255<o.r&&(o.r-=255),o.g-=127,o.g<0&&(o.g+=255),o.b-=127,o.b<0&&(o.b+=255),l=cnvRgbToHex(o.r,o.g,o.b)}else if(3==i){s.removeClass("cell_back_green"),s.addClass("cell_back_magenta"),s.removeClass("cell_back_red"),s.removeClass("cell_back_blue");var o=cnvHexToRgb(l);o.r+=255,255<o.r&&(o.r-=255),o.b+=255,255<o.b&&(o.b-=255),l=cnvRgbToHex(o.r,o.g,o.b)}else s.addClass("cell_back_green"),s.removeClass("cell_back_magenta"),s.removeClass("cell_back_red"),s.removeClass("cell_back_blue");s.css("background-color",l),n.text(a)}function curColMsg(e){$(".cur_col_msg").text(e)}function curStsMsg(e){$(".cur_sts_msg").text(e)}var reversiPlay=new ReversiPlay,reversiSetting=new ReversiSetting,reversiSettingBk=reversiSetting,storage=localStorage;$(document).ready(function(){jQuery(".minicolor").each(function(){jQuery(this).minicolors({control:jQuery(this).attr("data-control")||"hue",defaultValue:jQuery(this).attr("data-defaultValue")||"",inline:"true"===jQuery(this).attr("data-inline"),letterCase:jQuery(this).attr("data-letterCase")||"lowercase",opacity:jQuery(this).attr("data-opacity"),position:jQuery(this).attr("data-position")||"bottom left",change:function(e,r){e&&"object"==typeof console},theme:"bootstrap"})});var e=storage.getItem("appSetting");null!=e?reversiSetting=JSON.parse(e):storage.setItem("appSetting",JSON.stringify(reversiSetting)),void 0===reversiSetting.mPlayerColor1&&(reversiSetting.mPlayerColor1="#000000"),void 0===reversiSetting.mPlayerColor2&&(reversiSetting.mPlayerColor2="#ffffff"),void 0===reversiSetting.mBackGroundColor&&(reversiSetting.mBackGroundColor="#00ff00"),void 0===reversiSetting.mBorderColor&&(reversiSetting.mBorderColor="#000000"),set_menu_ui(),appInit(),reversiPlay.setSetting(reversiSetting),reversiPlay.reset(),$(".reversi_field").on("click",".square-wrapper",function(){var e=$(this).data("x"),r=$(this).data("y");console.log("x = "+e+",y = "+r),reversiPlay.reversiPlay(r,e)}),$(".reversi_field").on("click",".reset",function(){reversiPlay.reset()}),$(".reversi_field").on("click",".setting",function(){reversiSettingBk=reversiSetting}),$("#appMenuModal").on("click",".btn-primary",function(){reversiSetting.mMode=$("#mMode .active input").val(),reversiSetting.mType=$("#mType .active input").val(),reversiSetting.mPlayer=$("#mPlayer .active input").val(),reversiSetting.mAssist=$("#mAssist .active input").val(),reversiSetting.mGameSpd=$("#mGameSpd .active input").val(),reversiSetting.mGameSpd==DEF_GAME_SPD_FAST?(reversiSetting.mPlayCpuInterVal=DEF_GAME_SPD_FAST_VAL2,reversiSetting.mPlayDrawInterVal=DEF_GAME_SPD_FAST_VAL):reversiSetting.mGameSpd==DEF_GAME_SPD_MID?(reversiSetting.mPlayCpuInterVal=DEF_GAME_SPD_MID_VAL2,reversiSetting.mPlayDrawInterVal=DEF_GAME_SPD_MID_VAL):reversiSetting.mGameSpd==DEF_GAME_SPD_SLOW&&(reversiSetting.mPlayCpuInterVal=DEF_GAME_SPD_SLOW_VAL2,reversiSetting.mPlayDrawInterVal=DEF_GAME_SPD_SLOW_VAL),reversiSetting.mEndAnim=$("#mEndAnim .active input").val(),reversiSetting.mMasuCntMenu=$("#mMasuCntMenu .active input").val(),reversiSetting.mMasuCntMenu==DEF_MASU_CNT_6?reversiSetting.mMasuCnt=DEF_MASU_CNT_6_VAL:reversiSetting.mMasuCntMenu==DEF_MASU_CNT_8?reversiSetting.mMasuCnt=DEF_MASU_CNT_8_VAL:reversiSetting.mMasuCntMenu==DEF_MASU_CNT_10?reversiSetting.mMasuCnt=DEF_MASU_CNT_10_VAL:reversiSetting.mMasuCntMenu==DEF_MASU_CNT_12?reversiSetting.mMasuCnt=DEF_MASU_CNT_12_VAL:reversiSetting.mMasuCntMenu==DEF_MASU_CNT_14?reversiSetting.mMasuCnt=DEF_MASU_CNT_14_VAL:reversiSetting.mMasuCntMenu==DEF_MASU_CNT_16&&(reversiSetting.mMasuCnt=DEF_MASU_CNT_16_VAL);var e=reversiSetting.mTheme;reversiSetting.mTheme=$("#mTheme .active input").val(),$('head link[href="./css/theme/'+e+'/bootstrap.min.css"]').remove();var r='<link href="./css/theme/'+reversiSetting.mTheme+'/bootstrap.min.css" rel="stylesheet" media="screen">';$("head").append(r),reversiSetting.mPlayerColor1=$("#mPlayerColor1 input").val(),reversiSetting.mPlayerColor2=$("#mPlayerColor2 input").val(),reversiSetting.mBackGroundColor=$("#mBackGroundColor input").val(),reversiSetting.mBorderColor=$("#mBorderColor input").val(),storage.setItem("appSetting",JSON.stringify(reversiSetting)),appInit(),reversiPlay.setSetting(reversiSetting),reversiPlay.reset(),console.log(reversiSetting)}),$("#appMenuModal").on("click",".btn-warning",function(){reversiSetting=new ReversiSetting,set_menu_ui()}),$("#appMenuModal").on("click",".btn-default",function(){reversiSetting=reversiSettingBk,set_menu_ui()}),$("#appMenuModal").on("hidden.bs.modal",function(){console.log("appMenuModal close")});var r=!1;$(window).resize(function(){r!==!1&&clearTimeout(r),r=setTimeout(function(){set_masu_size_squer()},200)})}),$(window).load(function(){set_masu_size_squer()}),reversiPlay.setViewMsgDlgFunc(viewMsgDlg),reversiPlay.setDrawSingleFunc(drawSingle),reversiPlay.setCurColMsgFunc(curColMsg),reversiPlay.setCurStsMsgFunc(curStsMsg);